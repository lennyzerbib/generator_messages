<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GÃ©nÃ©rateur de Messages</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
    body { margin: 0; background:#0b0d12; color:#eef1f6; display:flex; min-height:100dvh; }
    .wrap { margin:auto; width:min(720px, 92vw); }
    .card { background:#121722; border:1px solid #222938; border-radius:16px; padding:24px; box-shadow: 0 8px 24px rgba(0,0,0,.25); }
    h1 { font-size:clamp(22px, 3.5vw, 28px); margin:0 0 8px; }
    p.hint { margin:0 0 18px; opacity:.85; }
    label { display:block; margin:14px 0 6px; font-weight:600; }
    input, select, button, .row { width:100%; }
    input, select { background:#0e121a; color:#eef1f6; border:1px solid #283042; border-radius:12px; padding:12px 14px; font-size:16px; outline:none; }
    input:focus, select:focus { border-color:#3e7aff; box-shadow:0 0 0 3px rgba(62,122,255,.2); }
    .row { display:flex; gap:10px; }
    .row > * { flex:1; }
    .country { flex: 1.2; }
    .phone { flex: 2; }
    button {
      margin-top:16px; background:#3e7aff; color:white; border:none; padding:13px 16px;
      border-radius:12px; font-size:16px; font-weight:700; cursor:pointer;
    }
    button:active { transform: translateY(1px); }
    .note { font-size:13px; opacity:.75; margin-top:10px; }
    .error { color:#ff7b7b; margin-top:10px; display:none; }
    footer { margin-top:16px; font-size:12px; opacity:.6; text-align:center; }

    /* Segmented button groups */
    .seg { display:flex; gap:8px; }
    .seg button {
      flex:1; margin-top:0; background:#0e121a; border:1px solid #283042; color:#eef1f6;
      padding:10px 12px; border-radius:10px; font-weight:600; cursor:pointer;
    }
    .seg button[aria-pressed="true"] { background:#3e7aff; color:#fff; border-color:#3e7aff; }
    .seg button:focus-visible { outline: 3px solid rgba(62,122,255,.5); outline-offset:2px; }

    /* Custom country code input */
    #customCodeWrap { display:none; }
    #customCode { letter-spacing: .5px; }
  </style>
</head>
<body>
  <main class="wrap">
    <div class="card">
      <h1>Messages : Villa Marina / Sephora</h1>
      <p class="hint">Choisissez la villa, l'appartement, le canal, puis saisissez le nom, les codes et le numÃ©ro. Nous ouvrirons lâ€™app correspondante avec le message prÃ©rempli.</p>

      <form id="wappForm">
        <!-- Boutons dÃ©pendants -->
        <label>Villa</label>
        <div class="seg" id="villaGroup" role="group" aria-label="Choix de la villa">
          <button type="button" data-value="Villa Marina" aria-pressed="true">Villa Marina</button>
          <button type="button" data-value="Villa Sephora" aria-pressed="false">Villa Sephora</button>
        </div>

        <label style="margin-top:12px">Appartement</label>
        <select id="optionSelect" aria-label="Choix d'option"></select>

        <label style="margin-top:12px">Canal</label>
        <div class="seg" id="channelGroup" role="group" aria-label="Choix du canal">
          <button type="button" data-value="whatsapp" aria-pressed="true">WhatsApp</button>
          <button type="button" data-value="sms" aria-pressed="false">Message (SMS)</button>
        </div>

        <!-- <label style="margin-top:12px">Langue</label>
        <div class="seg" id="language_message" role="group" aria-label="Choix du language">
          <button type="button" data-value="fr" aria-pressed="true">FranÃ§ais</button>
          <button type="button" data-value="en" aria-pressed="false">Anglais</button>
          <button type="button" data-value="es" aria-pressed="false">Espagnol</button>
          <button type="button" data-value="it" aria-pressed="false">Italien</button>
          <button type="button" data-value="ru" aria-pressed="false">Russe</button>
        </div> -->

        <label for="language_message">Langue du message</label>
        <div class="row">
          <select id="language_message" class="language" aria-label="Choix de la langue">
            <option value="fr" selected>ğŸ‡«ğŸ‡· FranÃ§ais</option>
            <option value="en">ğŸ‡¬ğŸ‡§ English</option>
            <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
            <option value="it">ğŸ‡®ğŸ‡¹ Italiano</option>
            <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
          </select>
        </div>

        <hr style="margin:18px 0;border:none;border-top:1px solid #222938" />

        <label for="name">Nom</label>
        <input id="name" name="name" type="text" placeholder="Ex. Lenny Zerbib" autocomplete="name" required />

        <label for="digicodeEntree">Digicode Immeuble</label>
        <input id="digicodeEntree" name="digicodeEntree" type="tel" inputmode="numeric" pattern="\d*" placeholder="Ex. 1234" />

        <label for="digicodeAppartement">Digicode Appartement</label>
        <input id="digicodeAppartement" name="digicodeAppartement" type="tel" inputmode="numeric" pattern="\d*" placeholder="Ex. 5678" />

        <label for="dateArrivee">Date dâ€™arrivÃ©e</label>
        <input id="dateArrivee" name="dateArrivee" type="date" required />

        <label for="dateDepart">Date de dÃ©part</label>
        <input id="dateDepart" name="dateDepart" type="date" required />

        <label for="phone">NumÃ©ro de tÃ©lÃ©phone</label>
        <div class="row">
          <select id="country" class="country" aria-label="Indicatif pays">
            <!-- Quelques indicatifs courants, FR par dÃ©faut -->
            <option value="+33" selected>ğŸ‡«ğŸ‡· +33 (France)</option>
            <option value="+32">ğŸ‡§ğŸ‡ª +32 (Belgique)</option>
            <option value="+41">ğŸ‡¨ğŸ‡­ +41 (Suisse)</option>
            <option value="+39">ğŸ‡®ğŸ‡¹ +39 (Italie)</option>
            <option value="+34">ğŸ‡ªğŸ‡¸ +34 (Espagne)</option>
            <option value="+49">ğŸ‡©ğŸ‡ª +49 (Allemagne)</option>
            <option value="+44">ğŸ‡¬ğŸ‡§ +44 (R.-Uni)</option>
            <option value="+1">ğŸ‡ºğŸ‡¸ +1 (USA/Canada)</option>
            <option value="+212">ğŸ‡²ğŸ‡¦ +212 (Maroc)</option>
            <option value="+216">ğŸ‡¹ğŸ‡³ +216 (Tunisie)</option>
            <option value="+213">ğŸ‡©ğŸ‡¿ +213 (AlgÃ©rie)</option>
            <option value="+971">ğŸ‡¦ğŸ‡ª +971 (EAU)</option>
            <option value="+91">ğŸ‡®ğŸ‡³ +91 (Inde)</option>
            <option value="+81">ğŸ‡¯ğŸ‡µ +81 (Japon)</option>
            <option value="+61">ğŸ‡¦ğŸ‡º +61 (Australie)</option>
            <option value="__custom">âœï¸ Autre indicatifâ€¦</option>
          </select>
          <input id="phone" class="phone" name="phone" type="tel" inputmode="tel" placeholder="Ex. +33612345678 ou 0612345678" required />
        </div>

        <div id="customCodeWrap" class="row" aria-hidden="true">
          <input id="customCode" class="country" type="text" inputmode="tel" placeholder="Entrez un indicatif au format +XXX (ex. +380)" />
        </div>

        <div id="error" class="error" role="alert">Veuillez entrer un numÃ©ro valide.</div>

        <button type="submit">Envoyer</button>

        <div class="note">
          Si vous mettez un <strong>0 initial</strong> (ex. 06â€¦), nous utiliserons lâ€™indicatif sÃ©lectionnÃ©.
          Vous pouvez aussi saisir un <strong>indicatif personnalisÃ©</strong> via Â« Autre indicatifâ€¦ Â».
        </div>
      </form>

      <footer>Fonctionne sur iPhone, Android, Windows, macOS &amp; WhatsApp Web.</footer>
    </div>
  </main>

  <script>
    async function shortenUrl(longUrl) {
      const BITLY_TOKEN = '39d7745c5d146325674c63a7b96349a260b81fd5';

      try {
        const res = await fetch('https://api-ssl.bitly.com/v4/shorten', {
          method: 'POST',
          headers: {
            'Authorization': 'Bearer ' + BITLY_TOKEN,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            long_url: longUrl
          })
        });

        if (!res.ok) {
          console.error('Bitly error status:', res.status);
          return longUrl; // fallback
        }

        const data = await res.json();
        return data.link || longUrl;
      } catch (err) {
        console.error('Bitly error:', err);
        return longUrl; // fallback
      }
    }


    const d_adresse = {
      'Villa Marina': '35 Avenue de Grasse, 06400 Cannes',
      'Villa Sephora': '27 Rue Meynadier, 06400 Cannes',
    };

    const dict_appartments = {
      'Little Havana': {
        villa: 'Villa Marina',
        etage: '1',
        orientation: 'Droite',
        wifi: 'Lan-1d',
        password_wifi: 'Siduzt-47@',
      },
      'Downtown': {
        villa: 'Villa Marina',
        etage: '2',
        orientation: 'Face',
        wifi: 'Lan-2f',
        password_wifi: 'Szkqjd-28@',
      },
      'Design District': {
        villa: 'Villa Marina',
        etage: '2',
        orientation: 'Droite',
        wifi: 'Lan-2d',
        password_wifi: 'Qkfhsu-95@',
      },
      'Coconut Grove Terrasse': {
        villa: 'Villa Marina',
        etage: '1',
        orientation: 'Face',
        wifi: 'Lan-1f',
        password_wifi: 'Dfkshr-98@',
      },
      'South Beach Terrasse': {
        villa: 'Villa Marina',
        etage: '3',
        orientation: 'Droite',
        wifi: 'Lan-3',
        password_wifi: 'Dbskgr-34@',
      },
      'Wynwood Loft': {
        villa: 'Villa Marina',
        etage: '0',
        orientation: 'RC',
        wifi: 'Lan-Rdc',
        password_wifi: 'Dghtod-45@',
      },
      'Villa Marina Building': {
        villa: 'Villa Marina',
        etage: '0',
        orientation: 'RC',
        wifi: 'Lan-Rdc',
        password_wifi: 'Dghtod-45@',
      },
      'Kos': {
        villa: 'Villa Sephora',
        etage: '1',
        orientation: 'Droite',
        wifi: 'Lan KOS',
        password_wifi: 'xI0$ufl~',
      },
      'Kea': {
        villa: 'Villa Sephora',
        etage: '2',
        orientation: 'Droite',
        wifi: 'Lan KEA',
        password_wifi: 'fbypl7q.',
      },
      'Samos': {
        villa: 'Villa Sephora',
        etage: '2',
        orientation: 'Milieu droit',
        wifi: 'Lan SAMOS',
        password_wifi: 'gyo4j!l|',
      },
      'Symi': {
        villa: 'Villa Sephora',
        etage: '2',
        orientation: 'Fond gauche',
        wifi: 'Lan SYMI',
        password_wifi: "9tav+h'o",
      },
      'Milos': {
        villa: 'Villa Sephora',
        etage: '2',
        orientation: 'Fond droite',
        wifi: 'Lan MILOS',
        password_wifi: 'e:yz7ceQ',
      },
      'Rhodes': {
        villa: 'Villa Sephora',
        etage: '2',
        orientation: '2Ã¨me gauche',
        wifi: 'Lan RHODES',
        password_wifi: '.$:qc+@q',
      },
      'Santorin': {
        villa: 'Villa Sephora',
        etage: '1',
        orientation: 'Gauche',
        wifi: 'Lan SANTORIN',
        password_wifi: 'ft;o?cm7',
      },
      'Corfou': {
        villa: 'Villa Sephora',
        etage: '2',
        orientation: 'Gauche',
        wifi: 'Lan COURFOU',
        password_wifi: 'tr+cn^t1',
      },
      'Mykonos': {
        villa: 'Villa Sephora',
        etage: '1',
        orientation: 'Face',
        wifi: 'Lan MYKONOS',
        password_wifi: 'Alo*LDJP',
      },
    };

    const d_suffix = {
      '0': { fr: '',   en: '',   es: '',  it: '',  ru: '' },
      '1': { fr: 'er', en: 'st', es: 'Âº', it: 'Âº', ru: 'Ğ¹' },
      '2': { fr: 'e',  en: 'nd', es: 'Âº', it: 'Âº', ru: 'Ğ¹' },
      '3': { fr: 'e',  en: 'rd', es: 'Âº', it: 'Âº', ru: 'Ğ¹' },
    };

    const ORIENTATION = {
      Droite: {fr: 'Droite', en: 'Right', es: 'Derecha', it: 'Destra', ru: 'Ğ¡Ğ¿Ñ€Ğ°Ğ²Ğ°' },
      Gauche: {fr: 'Gauche', en: 'Left', es: 'Izquierda', it: 'Sinistra', ru: 'Ğ¡Ğ»ĞµĞ²Ğ°' },
      Face: {fr: 'Face', en: 'Front', es: 'Frente', it: 'Fronte', ru: 'Ğ¡Ğ¿ĞµÑ€ĞµĞ´Ğ¸' },
      RC: {fr: 'RC', en: 'Ground Floor', es: 'Planta baja', it: 'Piano terra', ru: 'ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ ÑÑ‚Ğ°Ğ¶'}
    };

    function getOrientation(orientation, lang) {
      return ORIENTATION[orientation]?.[lang] || orientation;
    }

    function getAppartmentsByVilla(villaName) {
      const result = [];
      for (let key in dict_appartments) {
        const value = dict_appartments[key];
        if (typeof value === 'object' && !Array.isArray(value)) {
          if (value.villa === villaName) {
            result.push(key);
          }
        }
      }
      return result;
    }

    function getAppartmentDetail(option, language) {
      const raw = dict_appartments[option]['etage'];
      const etage = (!raw || raw == 0) ? '' : raw;

      const orientation = getOrientation(dict_appartments[option]['orientation'], language) || '';
      const suffix = d_suffix[etage]?.[language] || '';

      if (language === 'ru' && etage !== '') {
        return `${etage}-${suffix} ${orientation}`.trim();
      }

      return `${etage}${suffix} ${orientation}`.trim();
    }


    function setPressed(btn, pressed) { btn.setAttribute('aria-pressed', pressed ? 'true' : 'false'); }
    function getPressedValue(group) {
      const active = group.querySelector('button[aria-pressed="true"]');
      return active ? active.dataset.value : null;
    }
    function makeSegmentedInteractive(group) {
      group.addEventListener('click', (e) => {
        const btn = e.target.closest('button');
        if (!btn || !group.contains(btn)) return;
        group.querySelectorAll('button').forEach(x => setPressed(x, false));
        setPressed(btn, true);
      });
    }

    const villaGroup = document.getElementById('villaGroup');
    const optionSelect = document.getElementById('optionSelect');
    const channelGroup = document.getElementById('channelGroup');

    function refreshOptions() {
      const villa = getPressedValue(villaGroup);
      const list = villa === 'Villa Sephora' ? getAppartmentsByVilla('Villa Sephora') :
        getAppartmentsByVilla('Villa Marina Building').concat(getAppartmentsByVilla('Villa Marina'));
      optionSelect.innerHTML = '';
      const placeholder = document.createElement('option');
      placeholder.value = '';
      placeholder.textContent = 'â€” Choisir â€”';
      optionSelect.appendChild(placeholder);
      list.forEach(v => {
        const opt = document.createElement('option');
        opt.value = v; opt.textContent = v; optionSelect.appendChild(opt);
      });
      optionSelect.selectedIndex = 0;
    }

    // init segmented groups & options
    makeSegmentedInteractive(villaGroup);
    makeSegmentedInteractive(channelGroup);
    refreshOptions();

    // Quand on change de villa, mettre Ã  jour la liste
    villaGroup.addEventListener('click', (e) => {
      if (e.target.closest('button')) refreshOptions();
    });

    // --- Phone normalization ---
    function normalizeNumber(raw, countryCode) {
      let s = (raw || '').trim();
      s = s.replace(/[^\d+]/g, '');
      if (s.startsWith('00')) s = '+' + s.slice(2);
      if (s.startsWith('+')) return s.replace(/\++/g, '+');
      if (s.startsWith('0')) return countryCode + s.slice(1);
      return countryCode + s;
    }
    function toE164Digits(s) { return (s || '').replace(/\D/g, ''); }

    // --- Custom country code handling ---
    const countrySel = document.getElementById('country');
    const customWrap = document.getElementById('customCodeWrap');
    const customInput = document.getElementById('customCode');

    function currentDialCode() {
      if (countrySel.value === '__custom') return (customInput.value || '').trim();
      return countrySel.value;
    }
    function validateDialCode(code) { return /^\+\d{1,4}$/.test(code); }

    countrySel.addEventListener('change', () => {
      const isCustom = countrySel.value === '__custom';
      customWrap.style.display = isCustom ? 'flex' : 'none';
      customWrap.setAttribute('aria-hidden', isCustom ? 'false' : 'true');
      if (isCustom) customInput.focus();
    });

    // --- Submit handling ---
    document.getElementById('wappForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      const name = (document.getElementById('name').value || '').trim();
      const phoneRaw = document.getElementById('phone').value;
      const channel = getPressedValue(channelGroup) || 'whatsapp';
      const languageSelect = document.getElementById('language_message');
      const language = languageSelect.value || 'fr';

      let dial = currentDialCode();
      if (countrySel.value === '__custom') {
        if (!validateDialCode(dial)) {
          const errorEl = document.getElementById('error');
          errorEl.textContent = 'Veuillez saisir un indicatif personnalisÃ© valide (format +XXX).';
          errorEl.style.display = 'block';
          return;
        }
      } else if (!dial) {
        dial = '+33';
      }

      const normalized = normalizeNumber(phoneRaw, dial || '+33');
      const digits = toE164Digits(normalized);

      const errorEl = document.getElementById('error');
      if (!digits || digits.length < 8) {
        errorEl.textContent = 'Veuillez entrer un numÃ©ro valide.';
        errorEl.style.display = 'block';
        return;
      } else {
        errorEl.style.display = 'none';
      }

      const villa = getPressedValue(villaGroup) || '';
      const appartment = (document.getElementById('optionSelect').value || '');
      const detail_appart = getAppartmentDetail(appartment, language);
      const digicodeEntree = (document.getElementById('digicodeEntree').value || '');
      const digicodeAppartement = (document.getElementById('digicodeAppartement').value || '');
      const dateArrivee = document.getElementById('dateArrivee').value;
      const dateDepart = document.getElementById('dateDepart').value;
      const wifi = dict_appartments[appartment]?.wifi || '';
      const password_wifi = dict_appartments[appartment]?.password_wifi || '';
      const lockIcon = '\u{1F510}';

      const base = new URL('.', location.href).href;
      const contratUrl = base + 'contrat.html';

      function getWelcomeMessage() {
        if (language === 'fr') {
          return `Bonjour ${name},

Nous avons lâ€™immense plaisir de vous accueillir dans notre rÃ©sidence, la ${villa} Cannes!
Nous souhaitons que votre sÃ©jour se dÃ©roule de maniÃ¨re des plus agrÃ©ables. Permettez-nous de vous fournir toutes les informations importantes lors de votre sÃ©jour :

â€” Adresse : ${d_adresse[villa]}
â€” Appartement : ${appartment}, ${detail_appart}

â€” Code dâ€™accÃ¨s Ã  lâ€™immeuble :
                                  ${digicodeEntree} #
â€” Code dâ€™accÃ¨s Ã  votre apt :
                                  ${digicodeAppartement} ${lockIcon}

â€” Date d'ArrivÃ©e : ${dateArrivee}
â€” Date de DÃ©part : ${dateDepart}

â€” Wifi : ${wifi}
â€” Mot de Passe Wifi : ${password_wifi}

Pour refermer : faire le code et appuyer sur le cadenas 5 secondes
Avant dâ€™entrer votre code dâ€™accÃ¨s pour accÃ©der Ã  lâ€™appartement, veuillez patienter jusquâ€™Ã  ce que le clavier numÃ©rique sâ€™illumine, sâ€™il vous plaÃ®t. Cela indique que le clavier est prÃªt Ã  recevoir votre code.

Afin dâ€™assurer votre confort et votre satisfaction, nous tenons Ã  vous rappeler les points suivants :
  1. Entretien : Nous vous prions de bien vouloir prendre soin de lâ€™appartement pendant toute la durÃ©e de votre sÃ©jour. Lors de votre dÃ©part, nous vous saurions grÃ© de bien vouloir effectuer la vaisselle, vider les poubelles et laisser lâ€™appartement dans lâ€™Ã©tat oÃ¹ vous lâ€™avez trouvÃ©.
  2. Caution : Nous tenons Ã  vous informer quâ€™une empreinte de votre carte bancaire sera rÃ©alisÃ©e lors de votre arrivÃ©e. Soyez assurÃ©(e)(s) quâ€™aucun montant ne sera prÃ©levÃ©. Cette empreinte servira uniquement de garantie en cas de dommages Ã©ventuels.
  3. Respect du voisinage : Nous vous prions de faire preuve de courtoisie envers les autres rÃ©sidents de la ${villa}. Afin de prÃ©server la tranquillitÃ© de tous, veuillez Ã©viter les nuisances sonores, en particulier aprÃ¨s 22h.

Cher client, chÃ¨re cliente, chers clients, nous sommes vÃ©ritablement honorÃ©s de vous accueillir Ã  la ${villa} Cannes.
Notre Ã©quipe reste Ã  votre entiÃ¨re disposition pour rÃ©pondre Ã  vos questions et vous assister tout au long de votre sÃ©jour.
Profitez pleinement de votre expÃ©rience Ã  la ${villa} Cannes. Avec nos salutations les plus respectueuses,

Lâ€™Ã©quipe de la ${villa} Cannes`
        } else if (language === 'en') {
          return `Hello ${name},

We are delighted to welcome you to our residence, ${villa} Cannes!
We hope your stay will be as pleasant as possible. Please find below all the important information for your stay:

â€” Address: ${d_adresse[villa]}
â€” Apartment: ${appartment}, ${detail_appart}

â€” Building access code: ${digicodeEntree} #
â€” Your apartment access code: ${digicodeAppartement} ${lockIcon}

â€” Arrival Date: ${dateArrivee}
â€” Departure Date: ${dateDepart}

â€” Wifi : ${wifi}
â€” Wifi Password : ${password_wifi}

To close the door: enter the code and press the lock button for 5 seconds.
Before entering your access code to unlock the apartment door, please wait for the keypad to light up. This indicates that it is ready to receive your code.

To ensure your comfort and satisfaction, please note the following:
  1. Maintenance: We kindly ask you to take care of the apartment throughout your stay. Upon departure, please wash the dishes, empty the trash, and leave the apartment in the same condition in which you found it.
  2. Security deposit: Please note that a pre-authorization will be taken on your credit card upon arrival. Rest assured, no amount will be charged. This pre-authorization only serves as a guarantee in case of potential damages.
  3. Respect for neighbors: We kindly ask that you show consideration for the other residents of ${villa}. To preserve everyoneâ€™s peace and quiet, please avoid excessive noise, especially after 10 p.m.

Dear guest(s), we are truly honored to welcome you to ${villa} Cannes.
Our team remains at your full disposal for any questions or assistance throughout your stay.
We wish you a wonderful experience at ${villa} Cannes.

Warm regards,
The ${villa} Cannes Team`
        } else if (language === 'es') {
          return `Hola ${name},

Tenemos el gran placer de darle la bienvenida a nuestra residencia, ${villa} Cannes!
Deseamos que su estancia sea lo mÃ¡s agradable posible. PermÃ­tanos proporcionarle toda la informaciÃ³n importante para su estancia:

â€” DirecciÃ³n: ${d_adresse[villa]}
â€” Apartamento: ${appartment}, ${detail_appart}

â€” CÃ³digo de acceso al edificio: ${digicodeEntree} #
â€” CÃ³digo de acceso a su apartamento: ${digicodeAppartement} ${lockIcon}

â€” Fecha de llegada: ${dateArrivee}
â€” Fecha de salida: ${dateDepart}

â€” Wifi: ${wifi}
â€” ContraseÃ±a del Wifi: ${password_wifi}

Para cerrar la puerta: introduzca el cÃ³digo y mantenga pulsado el botÃ³n del candado durante 5 segundos.
Antes de introducir su cÃ³digo de acceso para entrar en el apartamento, por favor espere a que el teclado numÃ©rico se ilumine. Esto indica que estÃ¡ listo para recibir su cÃ³digo.

Para garantizar su comodidad y satisfacciÃ³n, queremos recordarle los siguientes puntos:
  1. Mantenimiento: Le rogamos cuidar del apartamento durante toda su estancia. Al marcharse, le agradecerÃ­amos que lavara los platos, vaciara la basura y dejara el apartamento en el mismo estado en el que lo encontrÃ³.
  2. DepÃ³sito de garantÃ­a: Le informamos de que se realizarÃ¡ una preautorizaciÃ³n en su tarjeta de crÃ©dito a su llegada. Le aseguramos que no se efectuarÃ¡ ningÃºn cargo. Esta preautorizaciÃ³n se utiliza Ãºnicamente como garantÃ­a en caso de posibles daÃ±os.
  3. Respeto al vecindario: Le pedimos que sea considerado(a) con los demÃ¡s residentes de ${villa}. Para preservar la tranquilidad de todos, evite ruidos molestos, especialmente despuÃ©s de las 22:00.

Estimado/a cliente, estamos realmente honrados de darle la bienvenida a ${villa} Cannes.
Nuestro equipo queda a su entera disposiciÃ³n para responder a sus preguntas y asistirle durante toda su estancia.
Le deseamos una maravillosa experiencia en ${villa} Cannes.

Con nuestros mÃ¡s cordiales saludos,
El equipo de ${villa} Cannes`
        } else if (language === 'it') {
          return `Caro/a ${name},

Siamo estremamente lieti di darLe il benvenuto nella nostra residenza, ${villa} Cannes!
Desideriamo che il Suo soggiorno sia il piÃ¹ piacevole possibile. Permetta che Le forniamo tutte le informazioni importanti per la Sua permanenza:

â€” Indirizzo: ${d_adresse[villa]}
â€” Appartamento: ${appartment}, ${detail_appart}

â€” Codice di accesso allâ€™edificio: ${digicodeEntree} #
â€” Codice di accesso al Suo appartamento: ${digicodeAppartement} ${lockIcon}

â€” Data di arrivo: ${dateArrivee}
â€” Data di partenza: ${dateDepart}

â€” Wifi: ${wifi}
â€” Password Wifi: ${password_wifi}

Per chiudere la porta: inserisca il codice e tenga premuto il pulsante del lucchetto per 5 secondi.
Prima di inserire il Suo codice di accesso per entrare nellâ€™appartamento, attenda gentilmente che il tastierino numerico si illumini. Questo indica che Ã¨ pronto a ricevere il codice.

Per garantirLe il massimo comfort e soddisfazione, La invitiamo a prendere nota dei seguenti punti:
  1. Manutenzione: La preghiamo di avere cura dellâ€™appartamento durante tutto il soggiorno. Al momento della partenza, La ringrazieremmo se potesse lavare i piatti, svuotare la spazzatura e lasciare lâ€™appartamento nelle stesse condizioni in cui lo ha trovato.
  2. Deposito cauzionale: La informiamo che, allâ€™arrivo, verrÃ  effettuata una pre-autorizzazione sulla Sua carta di credito. Le assicuriamo che non verrÃ  addebitato alcun importo. La pre-autorizzazione serve esclusivamente come garanzia in caso di eventuali danni.
  3. Rispetto del vicinato: La preghiamo di mostrare cortesia nei confronti degli altri residenti di ${villa}. Per garantire la tranquillitÃ  di tutti, eviti rumori molesti, soprattutto dopo le 22:00.

Gentile cliente, siamo davvero onorati di accoglierLa presso ${villa} Cannes.
Il nostro team Ã¨ a Sua completa disposizione per qualsiasi domanda o assistenza durante il Suo soggiorno.
Le auguriamo una splendida esperienza presso ${villa} Cannes.

Con i nostri piÃ¹ cordiali saluti,
Il team di ${villa} Cannes`
        } else if (language === 'ru') {
          return `Ğ£Ğ²Ğ°Ğ¶Ğ°ĞµĞ¼Ñ‹Ğ¹(Ğ°Ñ) ${name},

ĞœÑ‹ Ñ€Ğ°Ğ´Ñ‹ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²Ğ°Ñ Ğ² Ğ½Ğ°ÑˆĞµĞ¹ Ñ€ĞµĞ·Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ¸ ${villa} Cannes!
ĞĞ°Ğ´ĞµĞµĞ¼ÑÑ, Ñ‡Ñ‚Ğ¾ Ğ²Ğ°ÑˆĞµ Ğ¿Ñ€ĞµĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ ĞºĞ¾Ğ¼Ñ„Ğ¾Ñ€Ñ‚Ğ½Ñ‹Ğ¼. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¾Ğ·Ğ½Ğ°ĞºĞ¾Ğ¼ÑŒÑ‚ĞµÑÑŒ Ñ Ğ²Ğ°Ğ¶Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸ĞµĞ¹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ²Ğ°Ğ¼ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ¾Ğ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ:

â€” ĞĞ´Ñ€ĞµÑ: ${d_adresse[villa]}
â€” ĞĞ¿Ğ°Ñ€Ñ‚Ğ°Ğ¼ĞµĞ½Ñ‚Ñ‹: ${appartment}, ${detail_appart}

â€” ĞšĞ¾Ğ´ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ: ${digicodeEntree} #
â€” ĞšĞ¾Ğ´ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğ² Ğ²Ğ°ÑˆĞ¸ Ğ°Ğ¿Ğ°Ñ€Ñ‚Ğ°Ğ¼ĞµĞ½Ñ‚Ñ‹: ${digicodeAppartement} ${lockIcon}

â€” Ğ”Ğ°Ñ‚Ğ° Ğ·Ğ°ĞµĞ·Ğ´Ğ°: ${dateArrivee}
â€” Ğ”Ğ°Ñ‚Ğ° Ğ²Ñ‹ĞµĞ·Ğ´Ğ°: ${dateDepart}

â€” Wi-Fi: ${wifi}
â€” ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Wi-Fi: ${password_wifi}

Ğ§Ñ‚Ğ¾Ğ±Ñ‹ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ´Ğ²ĞµÑ€ÑŒ: Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ´ Ğ¸ ÑƒĞ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ñ Ğ·Ğ°Ğ¼ĞºĞ¾Ğ¼ 5 ÑĞµĞºÑƒĞ½Ğ´.
ĞŸĞµÑ€ĞµĞ´ Ğ²Ğ²Ğ¾Ğ´Ğ¾Ğ¼ ĞºĞ¾Ğ´Ğ° Ğ´Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´Ğ°, Ğ¿Ğ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ, Ğ¿Ğ¾ĞºĞ° Ğ½Ğµ Ğ·Ğ°Ğ³Ğ¾Ñ€Ğ¸Ñ‚ÑÑ ĞºĞ»Ğ°Ğ²Ğ¸Ğ°Ñ‚ÑƒÑ€Ğ° â€” ÑÑ‚Ğ¾ Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµÑ‚, Ñ‡Ñ‚Ğ¾ Ğ¾Ğ½Ğ° Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚ÑŒ ĞºĞ¾Ğ´.

Ğ”Ğ»Ñ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ ÑƒĞ´Ğ¾Ğ±ÑÑ‚Ğ²Ğ° Ğ¸ ĞºĞ¾Ğ¼Ñ„Ğ¾Ñ€Ñ‚Ğ°, Ğ¿Ñ€Ğ¾ÑĞ¸Ğ¼ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ¸Ñ‚ÑŒ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹:
  1. Ğ£Ğ±Ğ¾Ñ€ĞºĞ°: ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ±ĞµÑ€ĞµĞ¶Ğ½Ğ¾ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµÑÑŒ Ğº Ğ°Ğ¿Ğ°Ñ€Ñ‚Ğ°Ğ¼ĞµĞ½Ñ‚Ğ°Ğ¼ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ñ‚ÑĞ¶ĞµĞ½Ğ¸Ğ¸ Ğ²ÑĞµĞ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ. ĞŸÑ€Ğ¸ Ğ²Ñ‹ĞµĞ·Ğ´Ğµ Ğ¼Ñ‹ Ğ±ÑƒĞ´ĞµĞ¼ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹, ĞµÑĞ»Ğ¸ Ğ²Ñ‹ Ğ¿Ğ¾Ğ¼Ğ¾ĞµÑ‚Ğµ Ğ¿Ğ¾ÑÑƒĞ´Ñƒ, Ğ²Ñ‹Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚Ğµ Ğ¼ÑƒÑĞ¾Ñ€ Ğ¸ Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚Ğµ Ğ°Ğ¿Ğ°Ñ€Ñ‚Ğ°Ğ¼ĞµĞ½Ñ‚Ñ‹ Ğ² Ñ‚Ğ°ĞºĞ¾Ğ¼ Ğ¶Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸, Ğ² ĞºĞ°ĞºĞ¾Ğ¼ Ğ¾Ğ½Ğ¸ Ğ±Ñ‹Ğ»Ğ¸ Ğ¿Ñ€Ğ¸ Ğ·Ğ°ÑĞµĞ»ĞµĞ½Ğ¸Ğ¸.
  2. Ğ”ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚: ĞĞ±Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ Ğ²Ğ°ÑˆĞµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ, Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€Ğ¸ Ğ·Ğ°ÑĞµĞ»ĞµĞ½Ğ¸Ğ¸ Ğ±ÑƒĞ´ĞµÑ‚ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ° Ğ¿Ñ€ĞµĞ´Ğ²Ğ°Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° Ğ²Ğ°ÑˆĞµĞ¹ Ğ±Ğ°Ğ½ĞºĞ¾Ğ²ÑĞºĞ¾Ğ¹ ĞºĞ°Ñ€Ñ‚Ğµ. Ğ”ĞµĞ½ĞµĞ¶Ğ½Ñ‹Ğµ ÑÑ€ĞµĞ´ÑÑ‚Ğ²Ğ° ÑĞ¿Ğ¸ÑĞ°Ğ½Ñ‹ Ğ½Ğµ Ğ±ÑƒĞ´ÑƒÑ‚. Ğ­Ñ‚Ğ° Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑĞ»ÑƒĞ¶Ğ¸Ñ‚ Ğ»Ğ¸ÑˆÑŒ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸ĞµĞ¹ Ğ½Ğ° ÑĞ»ÑƒÑ‡Ğ°Ğ¹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾Ğ³Ğ¾ ÑƒÑ‰ĞµÑ€Ğ±Ğ°.
  3. Ğ¢Ğ¸ÑˆĞ¸Ğ½Ğ° Ğ¸ ÑƒĞ²Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğº ÑĞ¾ÑĞµĞ´ÑĞ¼: ĞŸÑ€Ğ¾ÑĞ¸Ğ¼ ÑĞ¾Ğ±Ğ»ÑĞ´Ğ°Ñ‚ÑŒ Ñ‚Ğ¸ÑˆĞ¸Ğ½Ñƒ Ğ¸ ÑƒĞ²Ğ°Ğ¶Ğ°Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… Ğ¶Ğ¸Ñ‚ĞµĞ»ĞµĞ¹ ${villa}. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¸Ğ·Ğ±ĞµĞ³Ğ°Ğ¹Ñ‚Ğµ ÑˆÑƒĞ¼Ğ°, Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ Ğ¿Ğ¾ÑĞ»Ğµ 22:00.

Ğ£Ğ²Ğ°Ğ¶Ğ°ĞµĞ¼Ñ‹Ğµ Ğ³Ğ¾ÑÑ‚Ğ¸, Ğ´Ğ»Ñ Ğ½Ğ°Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ°Ñ Ñ‡ĞµÑÑ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ñ‚ÑŒ Ğ²Ğ°Ñ Ğ² ${villa} Cannes.
ĞĞ°ÑˆĞ° ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ²ÑĞµĞ³Ğ´Ğ° Ğº Ğ²Ğ°ÑˆĞ¸Ğ¼ ÑƒÑĞ»ÑƒĞ³Ğ°Ğ¼ Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ Ğ²Ğ°Ğ¼ Ğ² Ğ»ÑĞ±Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ.
Ğ–ĞµĞ»Ğ°ĞµĞ¼ Ğ²Ğ°Ğ¼ Ğ¿Ñ€Ğ¸ÑÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ Ğ² ${villa} Cannes!

Ğ¡ ÑƒĞ²Ğ°Ğ¶ĞµĞ½Ğ¸ĞµĞ¼,
ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° ${villa} Cannes`
        }
        return '';
      }

      function buildPreviewUrl(message, digicodeImmeuble, digicodeAppartement, wifi, wifiPass) {
        const base = new URL('.', location.href).href; // mÃªme dossier
        const page = base + 'message_preview.html';

        const params = new URLSearchParams({
          message, // PAS de encodeURIComponent ici
          digicodeImmeuble,
          digicodeAppartement,
          wifi,
          wifiPass
        });

        return page + '?' + params.toString();
      }


      const message = getWelcomeMessage();

      const previewUrl = buildPreviewUrl(
        message,
        digicodeEntree,
        digicodeAppartement,
        wifi,
        password_wifi
      );

      const shortUrl = await shortenUrl(previewUrl);

      const finalMessage = `${message}

      â¡ï¸ Plus dâ€™informations ici :
      ${shortUrl}`;

      const encoded = encodeURIComponent(finalMessage);

      function openWhatsApp() {
        const waUrl = `https://wa.me/${digits}?text=${encoded}`;
        window.location.href = waUrl;
        setTimeout(() => {
          const deepLink = `whatsapp://send?phone=${digits}&text=${encoded}`;
          window.location.href = deepLink;
        }, 600);
      }
      function openSMS() {
        const isiOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
        const smsUrl = isiOS ? `sms:${digits}&body=${encoded}` : `sms:${digits}?body=${encoded}`;
        window.location.href = smsUrl;
      }

      if (channel === 'sms') openSMS(); else openWhatsApp();
    });
  </script>
</body>
</html>
